package com.xja.yygh.common.helper;import io.jsonwebtoken.*;import org.springframework.util.StringUtils;import java.util.Date;/** * @Author xiaoYan * @Data 2022/12/19 20:55 * 时间不早了  注意休息 */public class JwtHelper {    private static long tokenExpiration = 24*60*60*1000;    private static String tokenSignKey = "123456";    public static String createToken(Long userId, String userName) {        String token = Jwts.builder()                .setSubject("YYGH-USER")                .setExpiration(new Date(System.currentTimeMillis() + tokenExpiration))                .claim("userId", userId)                .claim("userName", userName)                .signWith(SignatureAlgorithm.HS512, tokenSignKey)                .compressWith(CompressionCodecs.GZIP)                .compact();        return token;    }    public static Long getUserId(String token) {        if(StringUtils.isEmpty(token)) {            return null;        }        Jws<Claims> claimsJws = Jwts.parser().setSigningKey(tokenSignKey).parseClaimsJws(token);        Claims claims = claimsJws.getBody();        Integer userId = (Integer)claims.get("userId");        return userId.longValue();    }    //根据token字符串获取用户id    public static String getUserName(String token) {        if(StringUtils.isEmpty(token)) {            return "";        }        Jws<Claims> claimsJws                = Jwts.parser().setSigningKey(tokenSignKey).parseClaimsJws(token);        Claims claims = claimsJws.getBody();        return (String)claims.get("userName");    }    //根据token 字符串获取用户名称    public static void main(String[] args) {        String token = JwtHelper.createToken(1L, "55");        System.out.println(token);        System.out.println(JwtHelper.getUserId(token));        System.out.println(JwtHelper.getUserName(token));    }}